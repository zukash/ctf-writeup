---
tags: [crypto, RSA]
createdAt: 2023/12/31
---

# frsa

## 要約

## 考察

本当にRSAか？と思った。

### n → (p, q)

小数から分数に変換して、分子・分母をそれぞれq,pとする。
アルゴリズムは分からないけど便利なツールがあった。

```python
n = Fraction(n).limit_denominator(1 << 768)
p = n.denominator
q = n.numerator

print(p, q)
```

精度の高い小数は、結構大きな情報を持っているんだなぁ。

### (p, q) → flag

(p,q)を既知としてflagを得る部分を考える。

`m^3`を`n (=q/p)`で割ったあまりが`c`なのだから、整数`a`を用いて、
`m^3 == a * q / p + c` と書ける。
小数は扱いにくいので、`p * m^3 == a * q + p * c` と変形する。
ここで、`p * c` は整数であるはず。
実際、非常に小さい誤差が出ていたが殆ど整数だった。
考察から小数を完全に排除したいので、`p * c`を丸め込み`pc`という一つの整数として考えることにする。

改めて、`p * m^3 == a * q + pc` を考える。
合同式を用いて表すと、`p * m^3 == pc (mod q)`となる。
`gcd(p, q) == 1` より `m^3 == pc * inverse(p) (mod q)`である。

`m < q`であるから、この情報だけで`m`は復元可能である。（略）

## 解法
