

# This file was *autogenerated* from the file solve.sage
from sage.all_cmdline import *   # import sage library

_sage_const_16 = Integer(16); _sage_const_0 = Integer(0); _sage_const_2 = Integer(2); _sage_const_1 = Integer(1); _sage_const_0x34096DC6CE88B7D7CB09DE1FEC1EDF9B448D4BE9E341A9F6DC696EF4E4E213B3 = Integer(0x34096DC6CE88B7D7CB09DE1FEC1EDF9B448D4BE9E341A9F6DC696EF4E4E213B3); _sage_const_0x3 = Integer(0x3); _sage_const_0x34096DC6CE88B7D7CB09DE1FEC1EDF9B448D4BE9E341A9F6DC696EF4E4E213B2 = Integer(0x34096DC6CE88B7D7CB09DE1FEC1EDF9B448D4BE9E341A9F6DC696EF4E4E213B2); _sage_const_0x2 = Integer(0x2); _sage_const_0x1 = Integer(0x1)
from hashlib import sha256
from os import urandom


def bytes_to_hexstr(buf):
    return "".join(["{0:02X}".format(b) for b in buf])


def bytes_to_int(buf):
    return int(bytes_to_hexstr(buf), _sage_const_16 )


def random_int(n):
    return bytes_to_int(urandom(n))


def sha256_as_int(x):
    return int(sha256(x).hexdigest(), _sage_const_16 )


def check_type(x, types):
    if len(x) != len(types):
        return False
    for a, b in zip(x, types):
        if not isinstance(a, b):
            return False
    return True


class Curve:
    def __init__(self, p, D, n):
        self.p = p
        self.D = D
        self.n = n

    def __repr__(self):
        return f"Curve(0x{self.p:X}, 0x{self.D:X})"

    def __eq__(self, other):
        return self.p == other.p and self.D == other.D

    def __matmul__(self, other):
        assert check_type(other, (int, int))
        assert other[_sage_const_0 ] ** _sage_const_2  % self.p == (self.D * other[_sage_const_1 ] ** _sage_const_2  + _sage_const_1 ) % self.p
        return Point(self, *other)


class Point:
    def __init__(self, C, x, y):
        assert isinstance(C, Curve)
        self.C = C
        self.x = x
        self.y = y

    def __repr__(self):
        return f"(0x{self.x:X}, 0x{self.y:X})"

    def __eq__(self, other):
        assert self.C == other.C
        return self.x == other.x and self.y == other.y

    def __add__(self, other):
        assert self.C == other.C
        x0, y0 = self.x, self.y
        x1, y1 = other.x, other.y
        return Point(
            self.C,
            (x0 * x1 + self.C.D * y0 * y1) % self.C.p,
            (x0 * y1 + x1 * y0) % self.C.p,
        )

    def __rmul__(self, n):
        assert check_type((n,), (int,))
        P = self.C @ (_sage_const_1 , _sage_const_0 )
        Q = self
        while n:
            if n & _sage_const_1 :
                P = P + Q
            Q = Q + Q
            n >>= _sage_const_1 
        return P

    def to_bytes(self):
        l = len(hex(self.C.p)[_sage_const_2 :])
        return self.x.to_bytes(l, "big") + self.y.to_bytes(l, "big")


C = Curve(
    _sage_const_0x34096DC6CE88B7D7CB09DE1FEC1EDF9B448D4BE9E341A9F6DC696EF4E4E213B3 ,
    _sage_const_0x3 ,
    _sage_const_0x34096DC6CE88B7D7CB09DE1FEC1EDF9B448D4BE9E341A9F6DC696EF4E4E213B2 ,
)
G = C @ (_sage_const_0x2 , _sage_const_0x1 )
print(G)

