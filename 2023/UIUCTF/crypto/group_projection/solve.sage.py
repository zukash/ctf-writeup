

# This file was *autogenerated* from the file /Users/zukash/Documents/ctf/crypto/uiuctf_2023/group_projection/solve.sage
from sage.all_cmdline import *   # import sage library

_sage_const_1337 = Integer(1337); _sage_const_1 = Integer(1); _sage_const_4 = Integer(4)
from pwn import *

while True:
    io = remote("group-projection.chal.uiuc.tf", int(_sage_const_1337 ))

    io.recvuntil(b"g = ")
    g = int(io.recvline())

    io.recvuntil(b"p = ")
    p = int(io.recvline())

    io.recvuntil(b"A = ")
    A = int(io.recvline())

    io.recvuntil(b"k = ")

    print(f"{p=}")
    print(f"{g=}")
    print(f"{A=}")
    k = (p - _sage_const_1 ) // _sage_const_4 
    if pow(g, k, p) == _sage_const_1 :
        io.sendline(str(k).encode())
        io.interactive()
    io.close()

