from sage.all import *


def gcd(a, b):
    while b:
        a, b = b, a % b
    return a.monic()


def franklinreiter(C1, C2, e, N, a, b):
    P = PolynomialRing(Zmod(N), "X")
    X = P.gen()
    g1 = (a * a * X + a * b + b) ** e - C1
    g2 = X**e - C2
    print(g1)
    print(g2)
    print("Result")
    result = gcd(g1, g2)
    return result


# print(franklinreiter(64, 8, 3, 97, 1, 1))


e = 65537
a = 104932596701958568145159429432079350581741243925294416012169671604384908382893445168447905864839450402111868722373005467040643335329799448356719960809485814400987619457043584576651627652936429829564657705560266433066823589229257859375942917575729874731586891094997845427952093627170472382405528285663530612106
b = 146908709759837063143862302770110984437045635655026319928249954800644806528614554086681623417268963974691959251767647958752898163761641238519061717835899588252518767306816402052353874469376243689011218283173950163484015487529897260943257598915903245695362042234335492571429369281809958738989439275152307290506
n = 68915438454431862553872087841423255330382510660515857448975005472053459609178709434028465492773792706094321524334359097372292237742328589766664933832084854448986045922250239618283612819975877218019020936022572963433202427817150998352120028655478359887600473211365524707624162292808256010583620102295206287739
c1 = "05d7913ff5cd9b6a706249ac05779f2501013ecc05caec697d9270a8a1d3bdaabf898d73410aa0ffbd361a6032adbbfa35386b2e19ec812e9f6bd52e6a2ca1b3760b3076a86ffc94dd6007d74a272e0e3d5326d9e5b01b9211a803338f5899ad6cc29877cc02ca2ff923db79e3ad477bf3820e73596088f54a8cfb187f812201"
c2 = "1913ba387e6f847dce455dc47092bf83571c34914b7df5875da536f11e68c8a39c78dfe69517ef4b389ea51434e071ce033854fd27c831996aa214cdc02225747a517d44408fbd0232672679bc189f26f6e9b6852a1e68e93ac14e2ce5afc1e050a44733094fe68b0477d4c4b609043e4da4e58390c4f9cf372005653c7f2529"
c3 = "45054a08d594bd8af1d0fac759ccc799214d0ccce8ae9c5183ef4fba296819bcdf6306f72ee34dcd5d85967fae314d6d3d65a7693b4187adce1d5375dd00c472c0310393cd5bb114602e24d481e276a4926e8886bdcfed96bb8bf9c5812d594f66e46b1737849e8e2f2c3f7b6a45e284c754cf6caf71df34efe143636b5e9079"
m1 = b"The quick brown fox jumps over the lazy dog"
m3 = b"https://translate.google.com/?sl=it&tl=en&text=ricerca"

c1 = int(c1, 16)
c2 = int(c2, 16)
c3 = int(c3, 16)
m1 = int.from_bytes(m1, "big")
m3 = int.from_bytes(m3, "big")

r1 = m1 ^ c1
r3 = m3 ^ c3

print(r1)
print(r3)

print(franklinreiter(r3, r1, e, n, a, b))


# # local
# # c1 = 13518718562541445262569935347767979413898056638479361252853435323181028901825515826044590246683290094212767016990975720218658047672179445273947011091097964592375444445935357005663659772602298711224958170210092950430655761749794970442301235559753269200169197105340988948599508842844170049883740971201858291453
# # c3 = 44448726641143217275856124519210798777728706520092366686122725528886254623369220685138797952293977311159038101401295403074110477424869268006696504561089163313906134109738293600440681305718677709695857237964899139714532245790958617161393653320525641955462120076976142112892766122753971330709994522796189680597
# # n = 89258991989144633918713862087868963835586181255911700638987915276559798594528063503552710823649300269584063884389782946569632448322551532421590572283201141573901244821690738136193534863951419924478341704774742676248781484466448012148474170815149714639240229845933685622147185599296554865141478927902650339229
# # a = 145824933670652798083299182108911824539369913934907443184246760880825787169631691240195042943796816375293478966333063976039467481917281489946873526407490388532593736321947784556239195760583709301555723253242369154231125667924646705672801298207410823102714823240409259041784138831105364823310412399128420384795
# # b = 171727944455625172477326993925177188683189865551698597502266067093261335136447031118532166461941340718316089816179615188159591186137518095624520633854965964510830520675340620385348300733160376683726298297643541259770189491027558565341746849276138836175421665309546697480356523748075900743632641439700291434402
# # e = 65537
