---
tags:
createdAt: 2025/05/24
---

# 4ES

## 概要

* AES は対称群
  * 長さ $n$ の文字列全体の集合を $S_n$ として、$S_n$ から $S_n$ への全単射写像になっている
* 半分全列挙

## 観察

* key の種類数は $\binom{14}{3} = 364$
* $c = (f_4 \circ f_3 \circ f_2 \circ f_1) (p)$ を満たす $f_1$, $f_2$, $f_3$, $f_4$ を見つけたい
* $f_4 \circ f_3 \circ f_2 \circ f_1$ を全探索すると $364 ^ 4$ 通り
* $(f_2 \circ f_1)(p) = (f_3^{-1} \circ f_4^{-1})(c)$ と変換して、これを満たす ($f_1$, $f_2$), ($f_3$, $f_4$) を探す
* $f_2 \circ f_1$ と $f_4 \circ f_3$ を全探索すると $2 \cdot 364^2$ 通り

## 解法
