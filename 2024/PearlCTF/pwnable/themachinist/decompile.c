/* This file was generated by the Hex-Rays decompiler version 8.3.0.230608.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 (**init_proc())(void);
void sub_1020();
void sub_1030();
void sub_1040();
void sub_1050();
void sub_1060();
void sub_1070();
void sub_1080();
void sub_1090();
void sub_10A0();
void sub_10B0();
void sub_10C0();
void sub_10D0();
void sub_10E0();
void sub_10F0();
void sub_1100();
// int __fastcall _cxa_finalize(void *);
// void free(void *ptr);
// int puts(const char *s);
// size_t fread(void *ptr, size_t size, size_t n, FILE *stream);
// int fclose(FILE *stream);
// int printf(const char *format, ...);
// int getchar(void);
// __int64 ftell(FILE *stream);
// void *malloc(size_t size);
// int fseek(FILE *stream, __int64 off, int whence);
// int setvbuf(FILE *stream, char *buf, int modes, size_t n);
// FILE *fopen(const char *filename, const char *modes);
// void perror(const char *s);
// __int64 __isoc99_scanf(const char *, ...); weak
void __fastcall __noreturn start(__int64 a1, __int64 a2, void (*a3)(void));
FILE **sub_1230();
__int64 sub_1260();
FILE **sub_12A0();
__int64 sub_12E0();
void term_proc();
// int __fastcall _libc_start_main(int (__fastcall *main)(int, char **, char **), int argc, char **ubp_av, void (*init)(void), void (*fini)(void), void (*rtld_fini)(void), void *stack_end);
// int __fastcall __cxa_finalize(void *);
// __int64 _gmon_start__(void); weak

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN main;
void *off_4008 = &off_4008; // idb
FILE *stdout; // idb
FILE *stdin; // idb
char byte_4028; // weak


//----- (0000000000001000) ----------------------------------------------------
__int64 (**init_proc())(void)
{
  __int64 (**result)(void); // rax

  result = &_gmon_start__;
  if ( &_gmon_start__ )
    return (__int64 (**)(void))_gmon_start__();
  return result;
}
// 40B8: using guessed type __int64 _gmon_start__(void);

//----- (0000000000001020) ----------------------------------------------------
void sub_1020()
{
  JUMPOUT(0LL);
}
// 1026: control flows out of bounds to 0

//----- (0000000000001030) ----------------------------------------------------
void sub_1030()
{
  sub_1020();
}

//----- (0000000000001040) ----------------------------------------------------
void sub_1040()
{
  sub_1020();
}

//----- (0000000000001050) ----------------------------------------------------
void sub_1050()
{
  sub_1020();
}

//----- (0000000000001060) ----------------------------------------------------
void sub_1060()
{
  sub_1020();
}

//----- (0000000000001070) ----------------------------------------------------
void sub_1070()
{
  sub_1020();
}

//----- (0000000000001080) ----------------------------------------------------
void sub_1080()
{
  sub_1020();
}

//----- (0000000000001090) ----------------------------------------------------
void sub_1090()
{
  sub_1020();
}

//----- (00000000000010A0) ----------------------------------------------------
void sub_10A0()
{
  sub_1020();
}

//----- (00000000000010B0) ----------------------------------------------------
void sub_10B0()
{
  sub_1020();
}

//----- (00000000000010C0) ----------------------------------------------------
void sub_10C0()
{
  sub_1020();
}

//----- (00000000000010D0) ----------------------------------------------------
void sub_10D0()
{
  sub_1020();
}

//----- (00000000000010E0) ----------------------------------------------------
void sub_10E0()
{
  sub_1020();
}

//----- (00000000000010F0) ----------------------------------------------------
void sub_10F0()
{
  sub_1020();
}

//----- (0000000000001100) ----------------------------------------------------
void sub_1100()
{
  sub_1020();
}

//----- (0000000000001200) ----------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn start(__int64 a1, __int64 a2, void (*a3)(void))
{
  __int64 v3; // rax
  int v4; // esi
  __int64 v5; // [rsp-8h] [rbp-8h] BYREF
  char *retaddr; // [rsp+0h] [rbp+0h] BYREF

  v4 = v5;
  v5 = v3;
  _libc_start_main((int (__fastcall *)(int, char **, char **))main, v4, &retaddr, 0LL, 0LL, a3, &v5);
  __halt();
}
// 120A: positive sp value 8 has been found
// 1211: variable 'v3' is possibly undefined

//----- (0000000000001230) ----------------------------------------------------
FILE **sub_1230()
{
  return &stdout;
}

//----- (0000000000001260) ----------------------------------------------------
__int64 sub_1260()
{
  return 0LL;
}

//----- (00000000000012A0) ----------------------------------------------------
FILE **sub_12A0()
{
  FILE **result; // rax

  if ( !byte_4028 )
  {
    if ( &__cxa_finalize )
      _cxa_finalize(off_4008);
    result = sub_1230();
    byte_4028 = 1;
  }
  return result;
}
// 4028: using guessed type char byte_4028;

//----- (00000000000012E0) ----------------------------------------------------
// attributes: thunk
__int64 sub_12E0()
{
  return sub_1260();
}

//----- (00000000000012E9) ----------------------------------------------------
__int64 __fastcall main(int a1, char **a2, char **a3)
{
  char v4; // [rsp+Bh] [rbp-55h] BYREF
  int v5; // [rsp+Ch] [rbp-54h] BYREF
  unsigned int v6; // [rsp+10h] [rbp-50h] BYREF
  int v7; // [rsp+14h] [rbp-4Ch]
  int v8; // [rsp+18h] [rbp-48h]
  int v9; // [rsp+1Ch] [rbp-44h]
  int v10; // [rsp+20h] [rbp-40h]
  unsigned int v11; // [rsp+24h] [rbp-3Ch]
  unsigned __int64 v12; // [rsp+28h] [rbp-38h] BYREF
  _BYTE *v13; // [rsp+30h] [rbp-30h] BYREF
  FILE *stream; // [rsp+38h] [rbp-28h]
  size_t n; // [rsp+40h] [rbp-20h]
  void *ptr; // [rsp+48h] [rbp-18h]
  int (__fastcall *v17)(int, char **, char **); // [rsp+50h] [rbp-10h]
  unsigned __int64 v18; // [rsp+58h] [rbp-8h]

  v18 = __readfsqword(0x28u);
  setvbuf(stdout, 0LL, 2, 0LL);
  setvbuf(stdin, 0LL, 1, 0LL);
  v8 = 0;
  v9 = 0;
  v10 = 0;
  puts("Welcome to the Sauce Adventure!");
  do
  {
    puts("\nMenu:");
    puts("1. The Sauce Guessing Game");
    puts("2. Make Your Own Sauce");
    puts("3. Check Your Eliteness");
    puts("4. Exit");
    printf("Enter your choice (1-4): ");
    if ( (unsigned int)__isoc99_scanf("%d", &v5) == 1 )
    {
      if ( v5 == 4 )
      {
        puts("Goodbye! Thanks for playing with sauces.");
        continue;
      }
      if ( v5 > 4 )
      {
LABEL_54:
        puts("Invalid choice. Please enter a number between 1 and 4.");
        continue;
      }
      switch ( v5 )
      {
        case 3:
          if ( v10 == 1337 )
          {
            stream = fopen("flag.txt", "r");
            if ( stream )
            {
              fseek(stream, 0LL, 2);
              n = ftell(stream);
              fseek(stream, 0LL, 0);
              ptr = malloc(n + 1);
              if ( !ptr )
              {
                perror("Error allocating memory");
                fclose(stream);
                return 2LL;
              }
              fread(ptr, 1uLL, n, stream);
              *((_BYTE *)ptr + n) = 0;
              printf("%s", (const char *)ptr);
              free(ptr);
              fclose(stream);
            }
            else
            {
              perror("Error opening file");
            }
          }
          else
          {
            puts("You're not elite enough to access this feature!");
          }
          break;
        case 1:
          if ( v8 )
          {
            puts("You've already played the secret sauce guessing game. Try making your own sauce!");
          }
          else
          {
            v17 = main;
            v11 = 100;
            v7 = 0;
            puts("You have stumbled upon a mysterious kitchen with a secret sauce. Try to guess its unique flavor.");
            printf("You have %d attempts!\n", v11);
            while ( v7 < (int)v11 )
            {
              printf("Enter your sauce recipe: ");
              if ( (unsigned int)__isoc99_scanf("%lu", &v12) == 1 )
              {
                ++v7;
                if ( (unsigned __int64)v17 <= v12 )
                {
                  if ( (unsigned __int64)v17 >= v12 )
                  {
                    puts("Congratulations! You got it right. Your sauce is perfectly balanced and extraordinary!");
                    break;
                  }
                  puts("Whoa! Your sauce is overdone!");
                }
                else
                {
                  puts("Oh no! Your sauce is bland!");
                }
              }
              else
              {
                puts("Invalid sauce!");
                while ( getchar() != 10 )
                  ;
              }
            }
            v8 = 1;
            if ( v7 == v11 )
              puts("Sorry, you've reached the maximum number of attempts. Your sauce remains a mystery.");
          }
          break;
        case 2:
          if ( v9 )
          {
            puts("You've already made your own sauce. Try something else!");
            break;
          }
          puts("Welcome to the 'Make Your Own Sauce' station!");
          puts("Feel free to experiment with various ingredients to create your unique sauce.");
          v13 = 0LL;
          printf("Enter an existing sauce that you want to experiment with: ");
          if ( (unsigned int)__isoc99_scanf("%p", &v13) != 1 )
          {
            puts("Invalid sauce!");
            break;
          }
          printf("Choose an ingredient: ");
          if ( (unsigned int)__isoc99_scanf("%d", &v6) != 1 || v6 >= 8 )
          {
            puts("What ingredient is that?!");
            break;
          }
          printf("Do you want to add or remove the ingredient ('a' to add, 'r' to remove): ");
          if ( (unsigned int)__isoc99_scanf(" %c", &v4) != 1 )
          {
            puts("Invalid operation!");
            break;
          }
          if ( v4 == 97 )
          {
            if ( !v13 )
              goto LABEL_39;
            *v13 |= 1 << v6;
            puts("Ingredient added successfully.");
          }
          else
          {
            if ( v4 != 114 )
            {
              puts("What did you just do?!");
              break;
            }
            if ( !v13 )
            {
LABEL_39:
              puts("The sauce blew up!");
              break;
            }
            *v13 &= ~(1 << v6);
            puts("Ingredient removed successfully.");
          }
          v9 = 1;
          break;
        default:
          goto LABEL_54;
      }
    }
    else
    {
      puts("Invalid input. Please enter a valid integer.");
      while ( getchar() != 10 )
        ;
    }
  }
  while ( v5 != 4 );
  return 0LL;
}
// 1423: conditional instruction was optimized away because %var_54.4<3
// 11F0: using guessed type __int64 __isoc99_scanf(const char *, ...);

//----- (00000000000018D8) ----------------------------------------------------
void term_proc()
{
  ;
}

// nfuncs=55 queued=23 decompiled=23 lumina nreq=0 worse=0 better=0
// ALL OK, 23 function(s) have been successfully decompiled
